@model GoldSilver.WebUI.Models.JewelriesListViewModel

@{
    Layout = "~/Views/Shared/_LayoutNew.cshtml";
    ViewBag.Title = "Список всіх виробів";
}

<h2>Список всіх виробів</h2>

@* Sorting buttons *@
@Html.ActionLink("Sort by Name", "List", new
{
    page = Model.PagingInfo.page,
    category = Model.CurrentCategory,
    sortBy = "Name",
    sortDirection = "ASC"
})
|
@Html.ActionLink("Sort by Weight", "List", new
{
    page = Model.PagingInfo.page,
    category = Model.CurrentCategory,
    sortBy = "Weight",
    sortDirection = "ASC"
})|
@Html.ActionLink("Sort by Popularity", "List", new
{
    page = Model.PagingInfo.page,
    category = Model.CurrentCategory,
    sortBy = "Popularity",
    sortDirection = "ASC"
})
|
@Html.ActionLink("Standart sorting", "List", new
{
    page = Model.PagingInfo.page,
    category = Model.CurrentCategory,
    sortBy = "Standart",
    sortDirection = "ASC"
})


<div class="row feature">
    @{ foreach (var j in Model.Jewelries)
       {
           Html.RenderPartial("JewelSummary", j);
       }
    }
</div>

<div class="row">
    <div class="col-lg-3 col-centered">
        <a href="#" class="btn btn-default" id="add-more">Даєш ще?</a>
        <svg id="loader" display="none" width='38px' height='38px' xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid" class="uil-ring-alt"><rect x="0" y="0" width="100" height="100" fill="none" class="bk"></rect><circle cx="50" cy="50" r="40" stroke="#e0e0e0" fill="none" stroke-width="10" stroke-linecap="round"></circle><circle cx="50" cy="50" r="40" stroke="#e8b5e6" fill="none" stroke-width="6" stroke-linecap="round"><animate attributeName="stroke-dashoffset" dur="2s" repeatCount="indefinite" from="0" to="502"></animate><animate attributeName="stroke-dasharray" dur="2s" repeatCount="indefinite" values="150.6 100.4;1 250;150.6 100.4"></animate></circle></svg>
    </div>
</div>

<div class="row">
    <div class="col-lg-3 col-centered">
        @Html.PageLinks(Model.PagingInfo, x => Url.Action("List", new { page = x, category = Model.CurrentCategory }))
    </div>
</div>

<script>
    var currentPage = @Model.PagingInfo.page +1;

    $("#add-more").click(function (event) {
        event.preventDefault();
        jQuery.ajax({
            url: '/Jewelries/GetPage?page=' + currentPage,
            beforeSend: function () {
                $('#loader').show();
                $('#add-more').hide();
            },
            complete: function () {
                $('#loader').hide();
                $('#add-more').show();
            },
            eror: function () {
                $('#loader').hide();
                $('#add-more').show();
            },
            success: function (result) {
                var jeweleries = result.Jewelries;
                $('#jewTmpl').tmpl(jeweleries).appendTo('.feature');
            }
        });
    });
</script>